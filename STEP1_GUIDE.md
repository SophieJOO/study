# 1단계 실행 가이드 (이번 주)

## 목표
✅ 기존 시스템은 그대로 유지
✅ 주간 집계 기능만 추가
✅ 안전하게 테스트

---

## 📋 체크리스트

- [ ] 스프레드시트 백업 완료
- [ ] weekly-attendance.gs 추가
- [ ] '주간집계' 시트 생성
- [ ] 테스트 실행
- [ ] 결과 확인

---

## 1️⃣ 스프레드시트 백업 (5분)

### 방법 1: 사본 만들기 (추천)
```
1. 현재 스프레드시트 열기
2. 상단 메뉴 > 파일 > 사본 만들기
3. 이름: "스터디 출석 백업 - 2025-11-22"
4. 위치: 내 드라이브 (또는 원하는 폴더)
5. "사본 만들기" 클릭
```

### 방법 2: 중요 시트만 복사
```
1. '제출기록' 시트 탭 우클릭
2. "다른 스프레드시트로 복사"
3. 새 스프레드시트 선택
4. '출석표' 시트도 같은 방법으로
```

**✅ 백업 완료 확인:**
- 백업 파일이 드라이브에 있나요?
- 열어서 데이터가 정상인가요?

---

## 2️⃣ Apps Script 편집기 열기 (2분)

```
1. 스프레드시트에서
2. 상단 메뉴 > 확장 프로그램 > Apps Script
3. 새 창이 열립니다
```

**현재 보이는 파일들:**
- `apps script code.gs` (기존 메인 코드)
- `index (1).html` (출석표)
- 기타 파일들

**⚠️ 중요: apps script code.gs는 건드리지 마세요!**

---

## 3️⃣ weekly-attendance.gs 추가 (3분)

### 방법:
```
1. Apps Script 편집기 왼쪽
2. "파일" 목록에서 "+" 클릭
3. "스크립트" 선택
4. 파일 이름: weekly-attendance
5. "만들기" 클릭
```

### 코드 복사-붙여넣기:

**파일 위치:**
- GitHub 브랜치: `claude/automate-study-attendance-014ZUzsrao7ry58X9nCMZra5`
- 파일명: `weekly-attendance.gs`

**전체 코드를 복사해서 새 파일에 붙여넣으세요.**

또는 아래 링크에서 다운로드:
```
https://github.com/SophieJOO/study/blob/claude/automate-study-attendance-014ZUzsrao7ry58X9nCMZra5/weekly-attendance.gs
```

### 저장:
```
1. Ctrl+S (또는 Cmd+S)
2. 또는 상단 디스크 아이콘 클릭
3. "저장됨" 메시지 확인
```

---

## 4️⃣ '주간집계' 시트 생성 (1분)

### 방법:
```
1. 스프레드시트로 돌아가기
2. 시트 탭 맨 아래 "+" 클릭
3. 새 시트 이름: 주간집계
4. Enter
```

### 헤더 행 추가 (선택사항):
```
A1: 년월
B1: 조원명
C1: 주차
D1: 주 시작
E1: 주 끝
F1: 인증횟수
G1: 필요횟수
H1: 장기오프일수
I1: 결석
J1: 비고
```

**이 단계는 선택사항입니다. 함수가 자동으로 생성해줍니다.**

---

## 5️⃣ 테스트 실행 (5분)

### 실행 방법:
```
1. Apps Script 편집기에서
2. weekly-attendance.gs 파일 열기
3. 상단 함수 선택 드롭다운 클릭
4. "이번달주간집계" 선택
5. "실행" 버튼 (▶️) 클릭
```

### 첫 실행 시 권한 요청:
```
1. "권한 검토" 팝업 → "권한 검토" 클릭
2. 구글 계정 선택
3. "고급" 클릭
4. "프로젝트 이름으로 이동(안전하지 않음)" 클릭
5. "허용" 클릭
```

**⚠️ "안전하지 않음" 경고는 정상입니다!**
자신의 스크립트라서 나오는 것입니다.

### 실행 로그 확인:
```
1. 실행 중 하단에 "실행 로그" 표시
2. 또는 상단 "실행 로그" 아이콘 클릭
3. 다음과 같은 로그가 보여야 합니다:

=== 2025년 11월 주간 집계 시작 ===
1주차 집계 중...
  센트룸: 인증 4/4회 → 결석 0회
  길: 인증 3/4회 → 결석 1회
  ...
✅ 주간 집계 완료
```

---

## 6️⃣ 결과 확인 (5분)

### 주간집계 시트 확인:
```
1. 스프레드시트로 돌아가기
2. '주간집계' 시트 탭 클릭
3. 데이터가 생성되어 있나요?
```

### 예상 결과:
```
년월     | 조원명 | 주차 | 주시작     | 주끝       | 인증 | 필요 | 장기오프 | 결석 | 비고
---------|--------|------|-----------|-----------|------|------|---------|------|------
2025-11  | 센트룸 | 1    | 2025-11-04 | 2025-11-10 | 4    | 4    | 0       | 0    |
2025-11  | 센트룸 | 2    | 2025-11-11 | 2025-11-17 | 3    | 4    | 0       | 1    |
2025-11  | 센트룸 | 3    | 2025-11-18 | 2025-11-24 | 4    | 4    | 0       | 0    |
```

### 정확성 검증:
```
1. 제출기록 시트 열기
2. 특정 조원의 특정 주 데이터 확인
3. 주간집계 결과와 일치하는지 확인

예: 센트룸의 2주차 (11/11 ~ 11/17)
- 제출기록에서 O 상태 개수 세기
- 주간집계의 "인증횟수"와 일치하는지 확인
```

---

## ✅ 1단계 완료 확인

다음을 모두 확인했나요?

- [x] 백업 파일이 있다
- [x] weekly-attendance.gs가 추가되었다
- [x] 이번달주간집계() 실행이 성공했다
- [x] 주간집계 시트에 데이터가 생성되었다
- [x] 데이터가 정확해 보인다
- [x] 기존 출석 체크가 여전히 작동한다 (제출기록 확인)

**모두 ✅ 이면 1단계 성공입니다!**

---

## 🎯 다음 단계 (1주일 후)

### 이번 주 동안 모니터링:
```
✅ 매일 출석 체크가 정상 작동하는지 확인
✅ 주간집계 데이터 정확성 확인
✅ 기존 시스템에 문제가 없는지 확인
```

### 1주일 후:
```
✅ 문제 없으면 2단계 진행 (gemini-ai.gs 추가)
⚠️ 문제 있으면 weekly-attendance.gs 제거
```

---

## 🚨 문제 발생 시

### 문제 1: 실행 오류
**증상:** "ReferenceError: CONFIG is not defined"
**원인:** apps script code.gs에 CONFIG가 없음
**해결:** CONFIG 변수 정의 확인

### 문제 2: 빈 결과
**증상:** 주간집계 시트가 비어있음
**원인:** 데이터가 없거나 월 설정 오류
**해결:**
```javascript
// 다른 월 테스트
월별주간집계(2025, 9); // 10월
```

### 문제 3: 기존 시스템 오류
**증상:** 출석 체크가 작동 안함
**해결:**
```
1. weekly-attendance.gs 파일 삭제
2. Apps Script 에디터에서 파일 우클릭 > 삭제
3. 저장
4. 원래대로 돌아옴
```

---

## 💡 팁

### 자동 실행 설정 (선택사항):
```
1. Apps Script > 트리거 (시계 아이콘)
2. "+ 트리거 추가"
3. 함수: 이번달주간집계
4. 이벤트: 시간 기반 / 일 타이머 / 오전 0~1시
5. 저장
```

**⚠️ 지금은 설정하지 마세요!**
1주일 검증 후 설정하는 게 안전합니다.

---

## 📞 도움이 필요하면

오류 메시지를 복사해서 알려주세요:
```
1. Apps Script > 실행 로그
2. 오류 메시지 전체 복사
3. 공유
```

---

**축하합니다! 1단계를 시작하셨습니다! 🎉**

1주일 후에 다시 확인하겠습니다.
